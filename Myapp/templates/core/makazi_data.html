{% extends 'base.html' %}
{% load static %}
{% block content %}
{% load phone_filters %}

<body class="inner-pages sin-1 homepage-4 hd-white">

    <!-- Wrapper -->
    <div id="wrapper">
        <!-- START SECTION HEADINGS -->
        <header id="header-container">
            <div id="header">
                <div class="container container-header">
                    <div class="left-side">
                        <div id="logo">
                            <a href="{% url 'popular_featured' %}"><img src="{% static 'images/logo-red.svg' %}" alt=""></a>
                        </div>
                        <div class="mmenu-trigger">
                            <button class="hamburger hamburger--collapse" type="button">
                                <span class="hamburger-box">
                                    <span class="hamburger-inner"></span>
                                </span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <div class="clearfix"></div>
        <!-- END SECTION HEADINGS -->

        <section class="single-proper blog details">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-md-12 blog-pots">
                        <div class="row">
                            <div class="col-md-12">
                                <section class="headings-2 pt-0">
                                    <div class="pro-wrapper">
                                        <div class="detail-wrapper-body">
                                            <div class="listing-title-bar">
                                                <h3>{{ listing.title }} 
                                                    <span class="mrg-l-5 category-tag">
                                                        {{ listing.status|default:"Available" }}
                                                    </span>
                                                </h3>
                                                <div class="mt-0">
                                                    <a href="#" class="listing-address">
                                                        <i class="fa fa-map-marker pr-2 ti-location-pin mrg-r-5"></i>
                                                        {{ listing.location|default:"Not Specified" }}
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="single detail-wrapper mr-2">
                                            <div class="detail-wrapper-body">
                                                <div class="listing-title-bar">
                                                    <h4> {{ listing.price|default:"N/A" }}</h4>
                                                    <div class="mt-0">
                                                        <a href="#" class="listing-address">
                                                            <p>{{ listing.house_size|default:"Size: Not Uploaded" }} (sq m)</p>
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </section>

                                <!-- main slider carousel -->
                                <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                                    <ol class="carousel-indicators">
                                        <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                                        <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                                        <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                                        <li data-target="#carouselExampleIndicators" data-slide-to="3"></li>
                                    </ol>
                                    <div class="carousel-inner carus" role="listbox">
                                        <div class="carousel-item active">
                                            <img class="d-block img-fluid" src="{{ listing.main_image_url|default:'/static/images/default.jpg' }}" alt="First slide">
                                        </div>
                                        <div class="carousel-item">
                                            <img class="d-block img-fluid" src="{{ listing.main_image_url|default:'/static/images/default.jpg' }}" alt="First slide">
                                            <!-- <img class="d-block img-fluid" src="{{ listing.image_1|default:'/static/images/default.jpg' }}" alt="Second slide"> -->
                                        </div>
                                        <div class="carousel-item">
                                            <img class="d-block img-fluid" src="{{ listing.main_image_url|default:'/static/images/default.jpg' }}" alt="First slide">
                                        </div>
                                        <div class="carousel-item">
                                            <img class="d-block img-fluid" src="{{ listing.main_image_url|default:'/static/images/default.jpg' }}" alt="First slide">
                                        </div>
                                    </div>
                                </div>

                                <!-- homes content -->
                                <div class="homes-content details-2 mb-4">
                                    <ul class="homes-list clearfix">
                                        <li><i class="fa fa-bed"></i> <span>{{ listing.bedrooms|default:"N/A" }} rooms</span></li>
                                        <li><i class="fa fa-bath"></i> <span>{{ listing.bathrooms|default:"N/A" }} Bath</span></li>
                                        <li><i class="fa fa-object-group"></i> <span>{{ listing.house_size|default:"-" }} sq m</span></li>
                                        <li><i class="fa fa-car"></i> <span>0 Garages</span></li>
                                        <li><i class="fa fa-columns"></i> <span>{{ listing.kitchen|default:"-" }} Kitchen</span></li>
                                        <li><i class="fa fa-clone"></i> <span>0 Balcony</span></li>
                                    </ul>
                                </div>

                                <!-- Description -->
                                <div class="blog-info details mb-30">
                                    <h5 class="mb-4">Description</h5>
                                    {% if user.is_authenticated %}
                                        <p class="mb-3">{{ listing.description }}</p>
                                    {% else %}
                                        <div class="locked-section" style="position: relative; overflow: hidden;">
                                            <div style="filter: blur(2px); opacity: 0.8;">
                                                <p class="mb-3">{{ listing.description|truncatechars:150 }}</p>
                                            </div>
                                            <div style="position: absolute; top:0; left:0; width:100%; height:100%;
                                                        display:flex; justify-content:center; align-items:center;
                                                        background: rgba(0,0,0,0.2);">
                                                <a href="{% url 'login' %}" style="text-decoration:none; color:white; text-align:center; animation:glowLock 2s infinite alternate;">
                                                    <span style="font-size:3rem;">ðŸ”’</span><br>
                                                    <small style="font-size:2rem; opacity:0.9; color:black;">Login to view</small>
                                                </a>
                                            </div>
                                        </div>
                                    {% endif %}
                                </div>

                                <style>
                                @keyframes glowLock {
                                    0% { text-shadow: 0 0 5px rgba(255,255,255,0.5); }
                                    100% { text-shadow: 0 0 15px rgba(255,255,255,0.9); }
                                }
                                </style>
                            </div>
                        </div>

                        <!-- Property Details -->
                        <div class="single homes-content details mb-30">
                            <h3 class="mb-4">Property Details</h3>
                            <ul class="homes-list clearfix" type="disc">
                                <li><span class="font-weight-bold mr-1">Property ID:</span> <span class="det">ðŸ”’ Hidden</span></li>
                                <li><span class="font-weight-bold mr-1">Property Type:</span> <span class="det">{{ listing.property_type|default:"House" }}</span></li>
                                <li><span class="font-weight-bold mr-1">Property Status:</span> <span class="det">{{ listing.status|default:"Available" }}</span></li>
                                <li><span class="font-weight-bold mr-1">Bei:</span> <span class="det">{{ listing.price|default:"N/A" }}</span></li>
                                <li><span class="font-weight-bold mr-1">Rooms:</span> <span class="det">{{ listing.bedrooms|default:"N/A" }}</span></li>
                                <li><span class="font-weight-bold mr-1">Baths:</span> <span class="det">{{ listing.bathrooms|default:"N/A" }}</span></li>
                                <li><span class="font-weight-bold mr-1">Garage:</span> <span class="det">0</span></li>
                                <li><span class="font-weight-bold mr-1">Posted:</span> <span class="det">{{ listing.scraped_at|default:"-" }}</span></li>
                            </ul>
                        </div>

                        <!-- Floor Plan -->
                        <div class="floor-plan property wprt-image-video w50 pro">
                            <h5>Floor Plans</h5>
                            <div>
                                <h4>Example of Image that should be Uploaded by Owner</h4>
                                <img alt="image" src="{% static 'images/bg/floor-plan-1.png' %}">
                            </div>
                        </div>

                        <!-- Nearby -->
                        <div class="floor-plan property wprt-image-video w50 pro">
                            <h5>What's Nearby</h5>
                            <div class="property-nearby">
                                <h6>{{ listing.nearby|default:"Not specified" }}</h6>
                            </div>
                        </div>

                        <!-- Video -->
                        <div class="property wprt-image-video w50 pro vid-si3">
                            <h5>Life is Simple With Us</h5>
                            <video controls style="width:100%; height:auto;">
                                <source src="{% static 'videos/default.mp4' %}" type="video/mp4">
                                Your browser does not support the video tag
                            </video>
                        </div>

                        <!-- Location -->
                        <div class="property-location map">
                            <h5>Location by Rank</h5>
                            <ul>
                                <li>{{ listing.location|default:"Tanzania" }}</li>
                                <!-- <li>{{ listing.region|default:"-" }}</li>
                                <li>{{ listing.district|default:"-" }}</li>
                                <li>{{ listing.ward|default:"-" }}</li> -->
                            </ul>
                        </div>
                    </div>

                    <!-- Sidebar -->
                    <aside class="col-lg-4 col-md-12 car">
                        <div class="single widget">
                            <div class="schedule widget-boxed mt-30">
                        <div class="widget-boxed-header">
                            <h4><i class="fa fa-calendar pr-3 padd-r-10"></i>Schedule a Tour</h4>
                        </div>
                        <div class="widget-boxed-body">
                            <div class="row">
                                <div class="col-lg-6 col-md-12 book">
                                    <input type="text" id="reservation-date" data-lang="en" data-large-mode="true" data-min-year="2017" data-max-year="2020" data-disabled-days="08/17/2017,08/18/2017" data-id="datedropper-0" data-theme="my-style" class="form-control" readonly="">
                                </div>
                                <div class="col-lg-6 col-md-12 book2">
                                    <input type="text" id="reservation-time" class="form-control" readonly="">
                                </div>
                            </div>
                            <div class="row mrg-top-15 mb-3">
                                <div class="col-lg-6 col-md-12 mt-4">
                                    <label class="mb-4">Adult</label>
                                    <div class="input-group">
                                        <span class="input-group-btn">
                                            <button type="button" class="btn counter-btn theme-cl btn-number" disabled="disabled" data-type="minus" data-field="quant[1]">
                                                <i class="fa fa-minus"></i>
                                            </button>
                                        </span>
                                        <input type="text" name="quant[1]" class="border-0 text-center form-control input-number" data-min="0" data-max="10" value="0">
                                        <span class="input-group-btn">
                                            <button type="button" class="btn counter-btn theme-cl btn-number" data-type="plus" data-field="quant[1]">
                                                <i class="fa fa-plus"></i>
                                            </button>
                                        </span>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-md-12 mt-4">
                                    <label class="mb-4">Children</label>
                                    <div class="input-group">
                                        <span class="input-group-btn">
                                            <button type="button" class="btn counter-btn theme-cl btn-number" disabled="disabled" data-type="minus" data-field="quant[2]">
                                                <i class="fa fa-minus"></i>
                                            </button>
                                        </span>
                                        <input type="text" name="quant[2]" class="border-0 text-center form-control input-number" data-min="0" data-max="10" value="0">
                                        <span class="input-group-btn">
                                            <button type="button" class="btn counter-btn theme-cl btn-number" data-type="plus" data-field="quant[2]">
                                                <i class="fa fa-plus"></i>
                                            </button>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        {% if user.is_authenticated %}
                            <!-- Kama ame-login, button inapeleka WhatsApp -->
                            <a href="https://wa.me/{{ property.business_phone|to_whatsapp }}" 
                            target="_blank" 
                            class="btn reservation btn-radius theme-btn full-width mrg-top-10">
                            Let's Chat In WhatsApp
                            </a>
                        {% else %}
                            <!-- Kama haja-login, button inaleta popup -->
                            <a href="#" 
                            onclick="showLoginPopup(event)" 
                            class="btn reservation btn-radius theme-btn full-width mrg-top-10">
                            Let's Chat In WhatsApp
                            </a>
                        {% endif %}

                        <!-- Popup -->
                        <div id="loginPopup" class="popup-overlay">
                            <div class="popup-content">
                                <p>ðŸ”’ Login to chat with owner</p>
                                <a href="{% url 'login' %}" class="popup-btn">Login</a>
                                <button onclick="closeLoginPopup()" class="popup-btn cancel">Cancel</button>
                            </div>
                        </div>

                        <style>
                        /* Popup overlay */
                        .popup-overlay {
                            display: none;
                            position: fixed;
                            top: 0; left: 0;
                            width: 100%; height: 100%;
                            background: rgba(0,0,0,0.6);
                            justify-content: center;
                            align-items: center;
                            z-index: 9999;
                        }

                        /* Popup box */
                        .popup-content {
                            background: #fff;
                            padding: 20px;
                            border-radius: 12px;
                            text-align: center;
                            max-width: 300px;
                            width: 90%;
                            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                        }

                        /* Popup buttons */
                        .popup-btn {
                            display: inline-block;
                            margin: 10px 5px 0;
                            padding: 8px 16px;
                            border-radius: 8px;
                            text-decoration: none;
                            font-size: 0.9rem;
                            cursor: pointer;
                        }
                        .popup-btn {
                            background: #007bff;
                            color: #fff;
                        }
                        .popup-btn.cancel {
                            background: #ff6b6b;
                            color: #fff;
                        }
                        </style>

                        <script>
                        function showLoginPopup(event) {
                            event.preventDefault();
                            document.getElementById("loginPopup").style.display = "flex";
                        }
                        function closeLoginPopup() {
                            document.getElementById("loginPopup").style.display = "none";
                        }
                        </script>

                        </div>
                    </div>


                        </div>

                        <!-- Owner Details -->
                        <div class="sidebar">
                            <div class="widget-boxed mt-33 mt-5">
                                <div class="widget-boxed-header"><h3>Owner Details</h3></div>
                                <div class="widget-boxed-body">
                                    <div class="author-box clearfix">
                                    <img src="{% static 'images/default.jpg' %}" alt="author-image" class="author__img" style="width: 50px; height: 50px; border-radius: 50%; object-fit: cover;">
                                        <h4 class="author__title">{{ listing.owner|default:"NyumbaChap Agent" }}</h4>
                                    </div>
                                    <ul class="author__contact">
                                        <li>{{ listing.location|default:"Tanzania" }}</li>
                                        <li>{% if user.is_authenticated %}{{ listing.business_phone|default:"Phone Number: Not Specified" }}{% else %}ðŸ”’ Hidden{% endif %}</li>
                                        <li>{% if user.is_authenticated %}{{ listing.business_email|default:"Email: Not Specified" }}{% else %}ðŸ”’ Hidden{% endif %}</li>
                                    </ul>

                                </div>
                            </div>
                        </div>

                        <!-- Caution -->
                        <div class="sidebar">
                            <div class="widget-boxed mt-33 mt-5">
                                <!-- cars List -->
                        <h5 style="background-color: white; color: rgb(255, 0, 0);">CAUTION..!</h5>
                        <dl style="background-color: white; color: rgb(255, 5, 5);">
                            <p>We would like to warn our clients about potential scammers that may appear when searching for properties on our website. Please take note of the following:

                            <dt>Verify Information:</dt>
                            <dd style="color: black;">Always make sure to verify the property ownerâ€™s information and price before making any payment.</dd>

                            <dt>Avoid Advance Payments:</dt>
                            <dd style="color: black;"> Do not feel compelled to make any payment before viewing the property, inspecting it, or signing official documents from the relevant local authority.</dd>

                            <dt>Report Fraudulent Incidents:</dt>
                            <dd style="color: black;">If you encounter any fraudulent activity, please report it to us immediately.</dd>

                            <dt>In Conclusion:</dt>
                            <dd style="color: black;">We will not be responsible for any scams that occur due to not following the instructions above.</dd>

                            Do not hesitate to ask us any questions for further assistance. We want to ensure you receive safe and reliable service!
                            </p>
                        </dl>                                                    
                            </div>
                        </div>
                    </aside>
                </div>
            </div>
        </section>
    </div>
</body>
{% endblock %}
